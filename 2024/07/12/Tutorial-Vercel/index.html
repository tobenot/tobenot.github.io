<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,viewport-fit=cover" name="viewport"><meta name="description" content="Vercel部署"><meta name="hexo-theme-A4" content="v1.8.9"><link rel="alternate icon" type="image/webp" href="/img/favicon.webp"><title>作家之屋</title><link rel="stylesheet" href="https://jsd.onmicrosoft.cn/npm/hexo-theme-a4@latest/source/css/highlight/style1.css"><link rel="stylesheet" href="https://jsd.onmicrosoft.cn/npm/hexo-theme-a4@latest/source/css/a11y-dark.min.css"><link rel="stylesheet" href="https://jsd.onmicrosoft.cn/npm/hexo-theme-a4@latest/source/css/reset.css"><link rel="stylesheet" href="https://jsd.onmicrosoft.cn/npm/hexo-theme-a4@latest/source/css/markdown.css"><link rel="stylesheet" href="https://jsd.onmicrosoft.cn/npm/hexo-theme-a4@latest/source/css/fonts.css"><link rel="stylesheet" href="https://jsd.onmicrosoft.cn/npm/hexo-theme-a4@latest/source/css/waline.css"><link rel="stylesheet" href="https://jsd.onmicrosoft.cn/npm/hexo-theme-a4@latest/source/css/ui.css"><link rel="stylesheet" href="https://jsd.onmicrosoft.cn/npm/hexo-theme-a4@latest/source/css/style.css"><link rel="stylesheet" href="https://jsd.onmicrosoft.cn/npm/hexo-theme-a4@latest/source/css/returnToTop.css"><link rel="stylesheet" href="https://jsd.onmicrosoft.cn/npm/hexo-theme-a4@latest/source/css/unicons.css"><link rel="stylesheet" href="https://jsd.onmicrosoft.cn/npm/hexo-theme-a4@latest/source/css/toc.css"><link rel="stylesheet" href="/css/returnToLastPage.css"><link rel="stylesheet" href="/css/lightgallery.min.css"><meta name="generator" content="Hexo 7.2.0"><link rel="alternate" href="/atom.xml" title="作家之屋" type="application/atom+xml">
</head><body><div class="left-toc-container"><nav id="toc" class="bs-docs-sidebar"></nav></div><div class="paper"><div class="shadow-drop-2-bottom paper-main"><div class="header"><div class="header-container"><img style="width:56px;height:auto" alt="^-^" cache-control="max-age=86400" class="header-img" src="/img/favicon.webp" width="10%"><div class="header-content"><a class="logo" href="/">作家之屋</a> <span class="description"></span></div></div><ul class="nav"><li><a href="/">🌟扉页</a></li><li><a href="/list/">📝手稿</a></li><li><a href="/about/">🦋作者</a></li></ul></div><div class="post-main"><div class="post-main-title">Vercel部署</div><div class="post-md"><ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Vercel"><span class="post-toc-text">Vercel</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Vercel-%E9%83%A8%E7%BD%B2%E5%A4%B1%E8%B4%A5%E9%97%AE%E9%A2%98"><span class="post-toc-text">Vercel 部署失败问题</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E6%9B%B4%E6%8D%A2-Vercel-%E7%9A%84%E5%9C%B0%E5%9D%80%E5%88%B0%E8%87%AA%E5%B7%B1%E7%9A%84"><span class="post-toc-text">更换 Vercel 的地址到自己的</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Vercel%E6%B5%81%E5%BC%8F%E5%93%8D%E5%BA%94"><span class="post-toc-text">Vercel流式响应</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#%E9%9D%9E%E6%B5%81%E5%BC%8F%E5%93%8D%E5%BA%94%E7%9A%84%E4%BB%A3%E7%A0%81"><span class="post-toc-text">非流式响应的代码</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#%E6%B5%81%E5%BC%8F%E5%93%8D%E5%BA%94%E7%9A%84%E4%BB%A3%E7%A0%81"><span class="post-toc-text">流式响应的代码</span></a></li></ol></li></ol></li></ol><link rel="stylesheet" type="text/css" href="https://jsd.onmicrosoft.cn/npm/hexo-theme-a4@latest/source/css/lightgallery.min.css"><div class=".article-gallery"><h2 id="Vercel"><a href="#Vercel" class="headerlink" title="Vercel"></a>Vercel</h2><h3 id="Vercel-部署失败问题"><a href="#Vercel-部署失败问题" class="headerlink" title="Vercel 部署失败问题"></a>Vercel 部署失败问题</h3><p>部署失败时，可以使用 <code>vercel --prod</code> 命令在命令行查看问题。</p><h3 id="更换-Vercel-的地址到自己的"><a href="#更换-Vercel-的地址到自己的" class="headerlink" title="更换 Vercel 的地址到自己的"></a>更换 Vercel 的地址到自己的</h3><ol><li><p>访问 GName 官网 <a target="_blank" rel="noopener" href="https://www.gname.com/user#/admin_ym">My Domains - GNAME control panel</a>。</p></li><li><p>在解析设置中添加一条记录：</p><ul><li>名称：anthurium（可以自定义）</li><li>类型：CNAME（实测 A 记录也行，但官方建议使用 CNAME）</li><li>值：<code>vercel.com</code> 或 <code>76.76.21.21</code></li></ul></li><li><p>在 Vercel 的部署服务器面板中，进入 <code>Settings</code> -&gt; <code>Domains</code>，假设域名是 <code>tobenot.top</code>，解析名是 <code>anthurium</code>，那么就添加一个 <code>anthurium.tobenot.top</code>。</p></li></ol><p>这样就可以将原本你使用的 Vercel 服务器地址都换成这个新的地址了。</p><h3 id="Vercel流式响应"><a href="#Vercel流式响应" class="headerlink" title="Vercel流式响应"></a>Vercel流式响应</h3><h4 id="非流式响应的代码"><a href="#非流式响应的代码" class="headerlink" title="非流式响应的代码"></a>非流式响应的代码</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> response = <span class="keyword">await</span> <span class="title function_">axios</span>(&#123;</span><br><span class="line">    <span class="attr">method</span>: req.<span class="property">method</span>,</span><br><span class="line">    <span class="attr">url</span>: targetUrl,</span><br><span class="line">    <span class="attr">headers</span>: headers,</span><br><span class="line">    <span class="attr">data</span>: req.<span class="property">body</span></span><br><span class="line">&#125;);</span><br><span class="line">res.<span class="title function_">status</span>(response.<span class="property">status</span>).<span class="title function_">json</span>(response.<span class="property">data</span>);</span><br></pre></td></tr></table></figure><h4 id="流式响应的代码"><a href="#流式响应的代码" class="headerlink" title="流式响应的代码"></a>流式响应的代码</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 检查是否请求流式响应</span></span><br><span class="line"><span class="keyword">if</span> (req.<span class="property">body</span> &amp;&amp; req.<span class="property">body</span>.<span class="property">stream</span> === <span class="literal">true</span>) &#123;</span><br><span class="line">    <span class="comment">// 设置响应头</span></span><br><span class="line">    res.<span class="title function_">writeHead</span>(<span class="number">200</span>, &#123;</span><br><span class="line">        <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;text/event-stream&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Cache-Control&#x27;</span>: <span class="string">&#x27;no-cache&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Connection&#x27;</span>: <span class="string">&#x27;keep-alive&#x27;</span></span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 创建到目标的请求</span></span><br><span class="line">    <span class="keyword">const</span> response =<span class="keyword">await</span> <span class="title function_">axios</span>(&#123;</span><br><span class="line">        <span class="attr">method</span>: req.<span class="property">method</span>,</span><br><span class="line">        <span class="attr">url</span>: targetUrl,</span><br><span class="line">        <span class="attr">headers</span>: headers,</span><br><span class="line">        <span class="attr">data</span>: req.<span class="property">body</span>,</span><br><span class="line">        <span class="attr">responseType</span>: <span class="string">&#x27;stream&#x27;</span></span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 将流数据传输到客户端</span></span><br><span class="line">    response.<span class="property">data</span>.<span class="title function_">on</span>(<span class="string">&#x27;data&#x27;</span>, <span class="function">(<span class="params">chunk</span>) =&gt;</span> &#123;</span><br><span class="line">        res.<span class="title function_">write</span>(chunk);</span><br><span class="line">    &#125;);</span><br><span class="line">    response.<span class="property">data</span>.<span class="title function_">on</span>(<span class="string">&#x27;end&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        res.<span class="title function_">end</span>();</span><br><span class="line">    &#125;);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// 非流式请求的处理保持不变</span></span><br><span class="line">    <span class="keyword">const</span> response = <span class="keyword">await</span> <span class="title function_">axios</span>(&#123;</span><br><span class="line">        <span class="attr">method</span>: req.<span class="property">method</span>,</span><br><span class="line">        <span class="attr">url</span>: targetUrl,</span><br><span class="line">        <span class="attr">headers</span>: headers,</span><br><span class="line">        <span class="attr">data</span>: req.<span class="property">body</span></span><br><span class="line">    &#125;);</span><br><span class="line">    res.<span class="title function_">status</span>(response.<span class="property">status</span>).<span class="title function_">json</span>(response.<span class="property">data</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><script src="https://jsd.onmicrosoft.cn/npm/hexo-theme-a4@latest/source/js/lightgallery.min.js"></script><script>if("undefined"!=typeof lightGallery){var options={selector:".gallery-item"};lightGallery(document.getElementsByClassName(".article-gallery")[0],options)}</script></div><div class="post-meta"><i><span>2024-07-12</span> <span>该篇文章被 tobenot</span> <span>打上标签: <a href="/tags/%E6%8A%80%E6%9C%AF/">技术 </a><a href="/tags/%E7%A2%8E%E7%89%87/">碎片 </a><a href="/tags/Vercel/">Vercel </a></span><span>归为分类: <a href="/categories/%E6%8A%80%E6%9C%AF/">技术</a></span></i></div><br><div class="comments-container"><div id="comment-anchor"></div><div class="comment-area-title">评论</div><div id="waline"></div><script type="module">import{init}from"https://npm.elemecdn.com/hexo-theme-a4@latest/source/js/waline.mjs";function loadWaline(){init({el:"#waline",serverURL:"https://mail.tobenot.top/",lang:"zh-CN",dark:'body[class~="dark-mode"]',requiredMeta:["nick","mail"],search:!1,reaction:!1,pageview:!1,comment:!1,locale:{placeholder:"也许从一个问题开始，才有答案。",sofa:""}})}window.addEventListener("DOMContentLoaded",loadWaline)</script></div></div><div class="footer"><span>© 2023-2024 China / <a href="/friends/">友链</a></span></div><div class="footer-last"><span>星界</span> <span class="footer-last-span-right"><i>本站由<a target="_blank" rel="noopener" href="https://hexo.io/zh-cn/index.html">Hexo</a>驱动｜使用<a target="_blank" rel="noopener" href="https://github.com/HiNinoJay/hexo-theme-A4">Hexo-theme-A4</a>主题</i></span></div><script src="https://jsd.onmicrosoft.cn/npm/hexo-theme-a4@latest/source/js/highlight.min.js"></script><script src="https://jsd.onmicrosoft.cn/npm/hexo-theme-a4@latest/source/js/highlightjs-line-numbers.js"></script><script src="https://jsd.onmicrosoft.cn/npm/hexo-theme-a4@latest/source/js/randomHeaderContent.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script><script src="https://jsd.onmicrosoft.cn/npm/hexo-theme-a4@latest/source/js/returnToTop.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.tocify/1.9.0/javascripts/jquery.tocify.min.js" type="text/javascript"></script><script src="https://jsd.onmicrosoft.cn/npm/hexo-theme-a4@latest/source/js/toc.js"></script><script src="/js/lightgallery.min.js"></script></div><div class="progress-wrap shadow-drop-2-bottom"><svg class="progress-circle svg-content" width="100%" height="100%" viewBox="-1 -1 102 102"><path d="M50,1 a49,49 0 0,1 0,98 a49,49 0 0,1 0,-98"/></svg></div><div class="return-to-last-progress-wrap shadow-drop-2-bottom"><svg class="progress-circle svg-content" width="100%" height="100%" viewBox="-1 -1 102 102"><path d="M50,1 a49,49 0 0,1 0,98 a49,49 0 0,1 0,-98"/></svg></div></div></body><script src="/js/darkmode-js.min.js"></script><script>function addDarkmodeWidget(){new Darkmode({bottom:"53px",right:"unset",left:"42px",time:"0.3s",mixColor:"#fff",backgroundColor:" #e4e4e4 ",buttonColorDark:"#100f2c",buttonColorLight:"#fff",saveInCookies:!0,label:"🌓",autoMatchOsTheme:!0}).showWidget()}window.addEventListener("load",addDarkmodeWidget)</script></html>