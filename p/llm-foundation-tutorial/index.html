<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,viewport-fit=cover" name="viewport"><meta name="description" content="大模型基础技术学习 - GPT提示词工程、Langchain、Function Call和JSON格式输出教程"><meta name="hexo-theme-A4" content="v2.0.0"><link rel="alternate icon" type="image/webp" href="/img/favicon.webp"><title>作家之屋</title><link rel="stylesheet" href="/css/highlight/style1.css"><link rel="stylesheet" href="/css/reset.css"><link rel="stylesheet" href="/css/markdown.css"><link rel="stylesheet" href="/css/fonts.css"><link rel="stylesheet" href="/css/waline.css"><link rel="stylesheet" href="/css/ui.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/returnToTop.css"><link rel="stylesheet" href="/css/unicons.css"><link rel="stylesheet" href="/css/toc.css"><link rel="stylesheet" href="/css/returnToLastPage.css"><link rel="stylesheet" href="/css/lightgallery-bundle.min.css"><link rel="stylesheet" href="/css/custom.css"><link rel="stylesheet" href="https://chinese-fonts-cdn.deno.dev/packages/lxgwwenkai/dist/LXGWWenKai-Regular/result.css"><meta name="generator" content="Hexo 7.2.0"><link rel="alternate" href="/atom.xml" title="作家之屋" type="application/atom+xml">
</head><body><script src="/js/darkmode-js.min.js"></script><div class="left-toc-container"><nav id="toc" class="bs-docs-sidebar"></nav></div><div class="paper"><div class="shadow-drop-2-bottom paper-main"><div class="header"><div class="header-container"><style>.header-img{width:56px;height:auto;object-fit:cover;transition:transform .3s ease-in-out;border-radius:0}</style><img alt="^-^" cache-control="max-age=86400" class="header-img" src="/img/favicon.webp"><div class="header-content"><a class="logo" href="/">作家之屋</a> <span class="description"></span></div></div><ul class="nav"><li><a href="/">🌟扉页</a></li><li><a href="/list/">✍️手稿</a></li><li><a href="/tags/article/">📝文章</a></li><li><a href="/tags/weekly/">📖刊物</a></li><li><a href="/tags/memorial/">🏅纪念</a></li><li><a href="/tags/before69/">🗃️归档</a></li><li><a href="/about/">🦋作者</a></li><li><a href="/friends/">👫荐友</a></li></ul></div><div class="post-main"><div class="post-main-title" style="text-align:center">大模型基础技术学习 - GPT提示词工程、Langchain、Function Call和JSON格式输出教程</div><div class="post-head-meta-center"><span>最近更新：2026-01-29</span> &nbsp; | &nbsp; <span>字数总计：978</span> &nbsp; | &nbsp; <span>阅读估时：4分钟</span> &nbsp; | &nbsp; <span id="busuanzi_container_page_pv">阅读量：<span id="busuanzi_value_page_pv"></span>次</span></div><div class="post-md"><ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#%E5%9F%BA%E7%A1%80"><span class="post-toc-text">基础</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E6%8F%90%E7%A4%BA%E8%AF%8D"><span class="post-toc-text">提示词</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Langchain"><span class="post-toc-text">Langchain</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#GPT%E7%9A%84Function-Call%E4%BD%BF%E7%94%A8"><span class="post-toc-text">GPT的Function Call使用</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%AE%98%E6%96%B9%E6%96%87%E6%A1%A3%E7%BF%BB%E8%AF%91"><span class="post-toc-text">官方文档翻译</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Function-Calling-Overview"><span class="post-toc-text">Function Calling Overview:</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Common-Use-Cases"><span class="post-toc-text">Common Use Cases:</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Basic-Sequence-of-Steps-for-Function-Calling"><span class="post-toc-text">Basic Sequence of Steps for Function Calling:</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Parallel-Function-Calling"><span class="post-toc-text">Parallel Function Calling:</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#GPT%E5%9B%9E%E5%A4%8D%E6%A0%BC%E5%BC%8F%E9%81%B5%E5%BE%AA"><span class="post-toc-text">GPT回复格式遵循</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E6%A0%BC%E5%BC%8F%E9%81%B5%E5%BE%AA%EF%BC%8C%E8%BF%94%E5%9B%9EJSON%E5%86%85%E5%AE%B9"><span class="post-toc-text">格式遵循，返回JSON内容</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#%E8%BF%94%E5%9B%9E%E7%A4%BA%E4%BE%8B"><span class="post-toc-text">返回示例</span></a></li></ol></li></ol></li></ol></li></ol><div class=".article-gallery"><h1 id="基础"><a href="#基础" class="headerlink" title="基础"></a>基础</h1><h2 id="提示词"><a href="#提示词" class="headerlink" title="提示词"></a>提示词</h2><p>使用大模型的基础。</p><iframe src="//player.bilibili.com/player.html?aid=783250146&bvid=BV1Z14y1Z7LJ&cid=1119200061&p=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen></iframe><h2 id="Langchain"><a href="#Langchain" class="headerlink" title="Langchain"></a>Langchain</h2><p>包含了一些基础的大模型技术实现介绍。</p><iframe src="//player.bilibili.com/player.html?aid=826991534&bvid=BV1zu4y1Z7mc&cid=1480951492&p=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen></iframe><h2 id="GPT的Function-Call使用"><a href="#GPT的Function-Call使用" class="headerlink" title="GPT的Function Call使用"></a>GPT的Function Call使用</h2><h3 id="官方文档翻译"><a href="#官方文档翻译" class="headerlink" title="官方文档翻译"></a>官方文档翻译</h3><h4 id="Function-Calling-Overview"><a href="#Function-Calling-Overview" class="headerlink" title="Function Calling Overview:"></a>Function Calling Overview:</h4><p>在 OpenAI API 中，Function Calling 允许你描述函数，并让模型智能地选择生成一个包含调用一个或多个函数的 JSON 对象的输出。Chat Completions API 不直接调用函数；相反，模型生成 JSON，然后你可以在你的代码中使用这个 JSON 调用函数。</p><p>最新的模型（例如 gpt-3.5-turbo-1106 和 gpt-4-turbo-preview）已经经过训练，可以智能地检测何时应该调用一个函数（根据输入）并以更贴近函数签名的方式生成 JSON。但需要注意，这种能力也带来潜在的风险。强烈建议在对用户产生影响的操作之前建立用户确认流程（发送电子邮件、在线发布内容、购买等）。</p><h4 id="Common-Use-Cases"><a href="#Common-Use-Cases" class="headerlink" title="Common Use Cases:"></a>Common Use Cases:</h4><p>函数调用允许你更可靠地从模型中获取结构化数据。例如，你可以：</p><p>创建能够通过调用外部 API 回答问题的助手（例如 ChatGPT 插件）。<br>将自然语言转换为 API 调用。<br>从文本中提取结构化数据。</p><h4 id="Basic-Sequence-of-Steps-for-Function-Calling"><a href="#Basic-Sequence-of-Steps-for-Function-Calling" class="headerlink" title="Basic Sequence of Steps for Function Calling:"></a>Basic Sequence of Steps for Function Calling:</h4><p>通过在 functions 参数中定义的一组函数和用户查询一起调用模型。<br>模型可以选择调用一个或多个函数；如果是这样，内容将是一个字符串化的 JSON 对象，符合你的自定义模式（注意：模型可能会产生参数幻觉）。<br>在代码中将字符串解析为 JSON，并使用提供的参数调用你的函数（如果存在）。<br>通过将函数响应附加为新消息再次调用模型，让模型总结结果并返回给用户。<br>Supported Models:</p><p>并非所有模型版本都经过函数调用数据的训练。支持函数调用的模型包括：gpt-4、gpt-4-turbo-preview、gpt-4-0125-preview、gpt-4-1106-preview、gpt-4-0613、gpt-3.5-turbo、gpt-3.5-turbo-1106 和 gpt-3.5-turbo-0613。</p><p>此外，以下模型支持并行函数调用：gpt-4-turbo-preview、gpt-4-0125-preview、gpt-4-1106-preview 和 gpt-3.5-turbo-1106。</p><h4 id="Parallel-Function-Calling"><a href="#Parallel-Function-Calling" class="headerlink" title="Parallel Function Calling:"></a>Parallel Function Calling:</h4><p>并行函数调用是模型同时执行多个函数调用的能力，允许这些函数调用的效果和结果并行解决。这在函数需要很长时间的情况下特别有用，并减少了与 API 的往返次数。</p><h2 id="GPT回复格式遵循"><a href="#GPT回复格式遵循" class="headerlink" title="GPT回复格式遵循"></a>GPT回复格式遵循</h2><h3 id="格式遵循，返回JSON内容"><a href="#格式遵循，返回JSON内容" class="headerlink" title="格式遵循，返回JSON内容"></a>格式遵循，返回JSON内容</h3><p>有时候需要模型返回JSON格式的内容，为了防止返回格式异常并提高模型性能，在调用 <code>gpt-4-1106-preview</code> 或 <code>gpt-3.5-turbo-1106</code> 时，可以将 <code>response_format</code> 参数设置为 <code>&#123; &quot;type&quot;: &quot;json_object&quot; &#125;</code> 以启用 JSON 模式。启用 JSON 模式后，模型被限制为仅生成解析为有效 JSON 的字符串。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">client = OpenAI(api_key=api_key)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">return_json</span>():</span><br><span class="line">    response = client.chat.completions.create(</span><br><span class="line">        model=<span class="string">&quot;gpt-4-1106-preview&quot;</span>,  <span class="comment"># gpt-3.5-turbo-1106</span></span><br><span class="line">        messages=[</span><br><span class="line">            &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;system&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&quot;You are a helpful assistant, return JSON format.&quot;</span>&#125;,  <span class="comment"># JSON is necessary</span></span><br><span class="line">            &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&quot;谁赢了2020年的世界杯?&quot;</span>&#125;,</span><br><span class="line">        ],</span><br><span class="line">        response_format=&#123;<span class="string">&quot;type&quot;</span>: <span class="string">&quot;json_object&quot;</span>&#125; <span class="comment"># text default</span></span><br><span class="line">    )</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;response:&#x27;</span>, response.choices[<span class="number">0</span>].message.content)</span><br></pre></td></tr></table></figure><h4 id="返回示例"><a href="#返回示例" class="headerlink" title="返回示例"></a>返回示例</h4><p>谁赢了2022年的世界杯? 返回的内容如下：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;winner&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Argentina&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;event&quot;</span><span class="punctuation">:</span> <span class="string">&quot;FIFA World Cup 2022&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;runner_up&quot;</span><span class="punctuation">:</span> <span class="string">&quot;France&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;location&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Qatar&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;date&quot;</span><span class="punctuation">:</span> <span class="string">&quot;December 18, 2022&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>如果启用了 <code>response_format=&#123;&quot;type&quot;: &quot;json_object&quot;&#125;</code>，但不在 Message 中加入 JSON 相关描述，就会强制报错，如下：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span>&#x27;error&#x27;<span class="punctuation">:</span> <span class="punctuation">&#123;</span>&#x27;message&#x27;<span class="punctuation">:</span> <span class="string">&quot;&#x27;messages&#x27; must contain the word &#x27;json&#x27; in some form, to use &#x27;response_format&#x27; of type &#x27;json_object&#x27;.&quot;</span><span class="punctuation">,</span> &#x27;type&#x27;<span class="punctuation">:</span> &#x27;invalid_request_error&#x27;<span class="punctuation">,</span> &#x27;param&#x27;<span class="punctuation">:</span> &#x27;messages&#x27;<span class="punctuation">,</span> &#x27;code&#x27;<span class="punctuation">:</span> None<span class="punctuation">&#125;</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></div></div><div class="post-meta"><i><span>2024-01-27</span> <span>该篇文章被 tobenot</span> <span>打上标签: <a href="/tags/before69/">before69 </a><a href="/tags/LLM/">LLM </a><a href="/tags/%E6%8A%80%E6%9C%AF/">技术 </a><a href="/tags/%E5%AE%8C%E6%95%B4/">完整 </a><a href="/tags/GPT/">GPT </a></span><span>归为分类: <a href="/categories/LLM/">LLM</a></span></i></div><br><div class="post-footer-pre-next"><span>上一篇：<a href="/p/spiritual-heart-world-history/index.html">心界录的一部分 - 关于阳明心学的精神世界对话录，探讨知行合一、致良知与成圣之道</a></span> <span class="post-footer-pre-next-last-span-right">下一篇：<a href="/p/playground-skyscraper-space-elevator/index.html">操场·高楼·太空电梯</a></span></div><div class="comments-container"><div id="comment-anchor"></div><div class="comment-area-title"></div><div id="giscus"></div><script src="https://giscus.app/client.js" data-repo="tobenot/tobenot.github.io" data-repo-id="R_kgDOKoavrA" data-category="Announcements" data-category-id="DIC_kwDOKoavrM4C1uDW" data-mapping="pathname" data-strict="0" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="bottom" data-theme="preferred_color_scheme" data-lang="zh-CN" crossorigin="anonymous" async></script></div></div><div class="footer"><span>© 2023-2024 China / <a href="/friends/">友链</a></span></div><div class="footer-last"><span>星界</span> <span class="footer-last-span-right"><i>本站由<a target="_blank" rel="noopener" href="https://hexo.io/zh-cn/index.html">Hexo</a>驱动｜使用<a target="_blank" rel="noopener" href="https://github.com/HiNinoJay/hexo-theme-A4">Hexo-theme-A4</a>主题</i></span></div><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.tocify/1.9.0/javascripts/jquery.tocify.min.js" type="text/javascript"></script><script src="/js/toc.js"></script><script src="/js/randomHeaderContent.js"></script><script src="/js/returnToTop.js"></script><script src="/js/returnToLastPage.js"></script><script src="/js/lightgallery/lightgallery.umd.min.js"></script><script src="/js/lightgallery/plugins/lg-thumbnail.umd.min.js"></script><script src="/js/lightgallery/plugins/lg-fullscreen.umd.min.js"></script><script src="/js/lightgallery/plugins/lg-autoplay.umd.min.js"></script><script src="/js/lightgallery/plugins/lg-zoom.umd.min.js"></script><script src="/js/lightgallery/plugins/lg-rotate.umd.min.js"></script><script src="/js/lightgallery/plugins/lg-paper.umd.min.js"></script><script type="text/javascript">if("undefined"!=typeof lightGallery){var options1={selector:".gallery-item",plugins:[lgThumbnail,lgFullscreen,lgAutoplay,lgZoom,lgRotate,lgPager],thumbnail:!0,zoom:!0,rotate:!0,autoplay:!0,fullScreen:!0,pager:!1,zoomFromOrigin:!0,actualSize:!0,enableZoomAfter:300};lightGallery(document.getElementsByClassName(".article-gallery")[0],options1)}</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><div class="progress-wrap shadow-drop-2-bottom"><svg class="progress-circle svg-content" width="100%" height="100%" viewBox="-1 -1 102 102"><path d="M50,1 a49,49 0 0,1 0,98 a49,49 0 0,1 0,-98"/></svg></div><div class="return-to-last-progress-wrap shadow-drop-2-bottom"><svg class="progress-circle svg-content" width="100%" height="100%" viewBox="-1 -1 102 102"><path d="M50,1 a49,49 0 0,1 0,98 a49,49 0 0,1 0,-98"/></svg></div></div></body></html><script src="/js/emojiHandler.js"></script><script>document.addEventListener("DOMContentLoaded",()=>{wrapEmojis(".paper")})</script>